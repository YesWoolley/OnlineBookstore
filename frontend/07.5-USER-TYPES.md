# Section 07.5: User Types

## Overview

This section defines all User-related TypeScript interfaces that match the backend `ApplicationUser` model and DTOs exactly.

## Backend Model Reference

### ApplicationUser Model
**üìç File: `EbooksPlatfor.Server/Models/ApplicationUser.cs`**
```csharp
public class ApplicationUser : IdentityUser
{
    public string? FirstName { get; set; }
    public string? LastName { get; set; }
    public string? FullName => $"{FirstName} {LastName}".Trim();
    public DateTime CreatedAt { get; set; }
    public string? RefreshToken { get; set; }
    public DateTime RefreshTokenExpiryTime { get; set; }

    // Navigation properties for relationships
    public ICollection<Order>? Orders { get; set; }
    public ICollection<Review>? Reviews { get; set; }
    public ICollection<ShoppingCartItem>? ShoppingCartItems { get; set; }
}
```

### UserDto (API Response)
**üìç File: `EbooksPlatfor.Server/DTOs/UserDto.cs`**
```csharp
public class UserDto
{
    public string Id { get; set; } = null!;
    public string UserName { get; set; } = null!;
    public string Email { get; set; } = null!;
    public string? FirstName { get; set; }
    public string? LastName { get; set; }
    public string? PhoneNumber { get; set; }
    public DateTime CreatedAt { get; set; }
    public ICollection<string> Roles { get; set; } = new List<string>();
}
```

## Frontend User Types

### Complete User Types File
**üìç File: `src/types/user.ts`**

```tsx:src/types/user.ts
// Main User interface matching backend ApplicationUser and UserDto
export interface User {
    // Core identification (from UserDto)
    id: string;
    userName: string;
    email: string;
    firstName?: string;
    lastName?: string;
    phoneNumber?: string;
    createdAt: string; // DateTime from backend converted to string
    
    // Roles from backend
    roles: string[];
    
    // Computed property from backend
    fullName?: string;
}

// For authentication forms (matching LoginDto)
export interface UserCredentials {
    userName: string;
    password: string;
    rememberMe?: boolean;
}

// For registration forms (matching RegisterDto)
export interface UserRegistration {
    userName: string;
    email: string;
    password: string;
    confirmPassword: string;
    firstName?: string;
    lastName?: string;
    phoneNumber?: string;
}

// For profile updates (matching UpdateProfileDto)
export interface UserProfileUpdate {
    firstName?: string;
    lastName?: string;
    phoneNumber?: string;
    email: string;  
}

// For password changes (matching ChangePasswordDto)
export interface PasswordChange {
    currentPassword: string;
    newPassword: string;
    confirmNewPassword: string;
}

// For API responses (matching AuthResultDto)
export interface AuthResponse {
    success: boolean;
    token?: string;
    refreshToken?: string;
    user?: User;
    message?: string;
}

// For password reset requests
export interface PasswordResetRequest {
    email: string;
}

export interface PasswordReset {
    token: string;
    newPassword: string;
    confirmPassword: string;
}

// Extended user interface for internal use (includes backend-only fields)
export interface ExtendedUser extends User {
    // Additional fields from ApplicationUser (not exposed in UserDto)
    refreshToken?: string;
    refreshTokenExpiryTime?: string;
    
    // Navigation properties (for internal use)
    orders?: any[];
    reviews?: any[];
    shoppingCartItems?: any[];
}

// User summary for lists and cards
export interface UserSummary {
    id: string;
    userName: string;
    fullName?: string;
    email: string;
    roles: string[];
}
```

## Type Mapping

### Backend to Frontend Field Mapping
```tsx
// Backend ApplicationUser ‚Üí Frontend User
public string Id ‚Üí id: string
public string UserName ‚Üí userName: string
public string Email ‚Üí email: string
public string? FirstName ‚Üí firstName?: string
public string? LastName ‚Üí lastName?: string
public string? PhoneNumber ‚Üí phoneNumber?: string
public DateTime CreatedAt ‚Üí createdAt: string
public ICollection<string> Roles ‚Üí roles: string[]
```

### DTO Mapping
```tsx
// Backend LoginDto ‚Üí Frontend UserCredentials
public string UserName ‚Üí userName: string
public string Password ‚Üí password: string

// Backend RegisterDto ‚Üí Frontend UserRegistration
public string UserName ‚Üí userName: string
public string Email ‚Üí email: string
public string Password ‚Üí password: string
public string ConfirmPassword ‚Üí confirmPassword: string
public string? FirstName ‚Üí firstName?: string
public string? LastName ‚Üí lastName?: string
public string? PhoneNumber ‚Üí phoneNumber?: string
```

## Usage Examples

### In Components
```tsx:src/components/auth/SignIn.tsx
import type { User, UserCredentials } from '../../types/user';

const [formData, setFormData] = useState<UserCredentials>({
    userName: '',
    password: '',
    rememberMe: false
});

const [user, setUser] = useState<User | null>(null);
```

### In API Calls
```tsx:src/services/authService.ts
const signIn = async (credentials: UserCredentials): Promise<AuthResponse> => {
    const response = await fetch('/api/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(credentials)
    });
    return response.json();
};
```

### In Props
```tsx:src/components/UserProfile.tsx
interface UserProfileProps {
    user: User;
    onUpdateProfile: (updates: UserProfileUpdate) => void;
}
```

## Key Compliance Points

- ‚úÖ **Field Names**: Match backend exactly (`userName`, not `username`)
- ‚úÖ **Optional Fields**: Use `?` for nullable backend fields
- ‚úÖ **Data Types**: Convert backend types appropriately (DateTime ‚Üí string)
- ‚úÖ **Required Fields**: Match backend required fields exactly
- ‚úÖ **Computed Properties**: Include backend computed properties

The User types ensure complete compatibility between frontend and backend! üéØ‚ú® 